@page "/auth/external-login-callback"
@using TLMaster.UI.Services
@inject AuthService AuthService
@inject NavigationManager NavigationManager
@rendermode InteractiveServer

<h3>Login Callback</h3>

<p>Processando seu login...</p>

@code {
    private bool _isCallbackProcessed = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && !_isCallbackProcessed)
        {
            _isCallbackProcessed = true;
            var returnUrl = NavigationManager.BaseUri;
            await AuthService.HandleExternalLoginCallbackAsync(returnUrl);
        }
    }
}