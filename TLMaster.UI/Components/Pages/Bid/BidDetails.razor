@page "/bids/{BidId}"
@using TLMaster.UI.Model.Models
@using TLMaster.UI.Services

@inject BidService BidService
@inject NavigationManager NavigationManager

<Details TItem="BidModel" TId="string"
         ItemName="Bid"
         Item="bid"
         GetItemName="@(c => c.Bidder.Name)"
         NavigateToEdit="NavigateToEdit"
         DeleteItem="DeleteBid">
    <ChildContent>
        <p><strong>Amount:</strong> @context.Amount</p>
        <p><strong>Bidder:</strong> <a href="/characters/@context.Bidder.Id">@context.Bidder.Name</a> </p>
    </ChildContent>
</Details>

@code {
    [Parameter] public string BidId { get; set; } = string.Empty;
    private BidModel? bid;

    protected override async Task OnInitializedAsync()
    {
        bid = await BidService.GetByIdAsync(BidId);
    }

    private void NavigateToEdit()
    {
        NavigationManager.NavigateTo($"/edit-bid/{BidId}");
    }

    private async Task DeleteBid()
    {
        var result = await BidService.DeleteAsync(BidId);
        if (result)
        {
            NavigationManager.NavigateTo("/bids");
        }
    }
}